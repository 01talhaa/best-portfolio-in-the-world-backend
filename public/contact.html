<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact API Testing</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .nav {
            background: #f8f9fa;
            padding: 15px 30px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .nav a {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
        }
        
        .content {
            padding: 30px;
        }
        
        .test-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border: 2px solid #e9ecef;
        }
        
        .test-section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #495057;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .form-group textarea {
            height: 120px;
            resize: vertical;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        
        .response-area {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .method-tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .method-get { background: #d4edda; color: #155724; }
        .method-post { background: #cce5ff; color: #004085; }
        .method-put { background: #fff3cd; color: #856404; }
        .method-delete { background: #f8d7da; color: #721c24; }
        
        .token-input {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }
        
        .sample-forms {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .sample-form {
            background: #e8f5e8;
            border: 1px solid #27ae60;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .sample-form:hover {
            background: #27ae60;
            color: white;
        }
        
        .sample-form h5 {
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .sample-form p {
            font-size: 0.8rem;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìß Contact API Testing</h1>
            <p>Test contact form submissions and inquiry management</p>
        </div>
        
        <div class="nav">
            <a href="index.html">‚Üê Back to Dashboard</a>
        </div>
        
        <div class="content">
            <!-- Auth Token Input -->
            <div class="token-input">
                <label for="authToken">Authorization Token (required for protected routes):</label>
                <input type="text" id="authToken" placeholder="Enter JWT token from login" style="margin-top: 10px;">
            </div>
            
            <!-- Submit Contact Form -->
            <div class="test-section">
                <h3>Submit Contact Form</h3>
                <span class="method-tag method-post">POST /api/v1/contact</span>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Full Name:</label>
                        <input type="text" id="submitName" value="John Smith">
                    </div>
                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" id="submitEmail" value="john.smith@example.com">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Phone:</label>
                        <input type="text" id="submitPhone" value="+1-555-0123">
                    </div>
                    <div class="form-group">
                        <label>Company:</label>
                        <input type="text" id="submitCompany" value="Tech Solutions Inc.">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Subject:</label>
                        <input type="text" id="submitSubject" value="Website Development Inquiry">
                    </div>
                    <div class="form-group">
                        <label>Inquiry Type:</label>
                        <select id="submitInquiryType">
                            <option value="General Inquiry">General Inquiry</option>
                            <option value="Project Quote" selected>Project Quote</option>
                            <option value="Technical Support">Technical Support</option>
                            <option value="Partnership">Partnership</option>
                            <option value="Job Application">Job Application</option>
                            <option value="Feedback">Feedback</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Message:</label>
                    <textarea id="submitMessage">Hello,

I am interested in discussing a potential web development project for our company. We are looking to build a modern e-commerce platform with the following requirements:

- Responsive design for mobile and desktop
- User authentication and account management
- Product catalog with search and filtering
- Shopping cart and checkout functionality
- Payment gateway integration
- Admin dashboard for content management

Could we schedule a consultation to discuss the project details, timeline, and pricing?

Thank you for your time.

Best regards,
John Smith</textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Budget Range:</label>
                        <select id="submitBudget">
                            <option value="Under $5,000">Under $5,000</option>
                            <option value="$5,000 - $15,000" selected>$5,000 - $15,000</option>
                            <option value="$15,000 - $50,000">$15,000 - $50,000</option>
                            <option value="$50,000+">$50,000+</option>
                            <option value="Not specified">Not specified</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Timeline:</label>
                        <select id="submitTimeline">
                            <option value="ASAP">ASAP</option>
                            <option value="1-3 months" selected>1-3 months</option>
                            <option value="3-6 months">3-6 months</option>
                            <option value="6+ months">6+ months</option>
                            <option value="Flexible">Flexible</option>
                        </select>
                    </div>
                </div>
                
                <div class="sample-forms">
                    <div class="sample-form" onclick="loadSampleForm('webdev')">
                        <h5>üåê Web Development</h5>
                        <p>Standard web development inquiry</p>
                    </div>
                    <div class="sample-form" onclick="loadSampleForm('mobile')">
                        <h5>üì± Mobile App</h5>
                        <p>Mobile application development</p>
                    </div>
                    <div class="sample-form" onclick="loadSampleForm('ecommerce')">
                        <h5>üõí E-commerce</h5>
                        <p>Online store development</p>
                    </div>
                    <div class="sample-form" onclick="loadSampleForm('support')">
                        <h5>üîß Tech Support</h5>
                        <p>Technical support request</p>
                    </div>
                </div>
                
                <button class="btn" onclick="submitContactForm()">Submit Contact Form</button>
                <button class="btn btn-secondary" onclick="clearResponse('submitResponse')">Clear</button>
                
                <div id="submitResponse" class="response-area" style="display: none;"></div>
            </div>
            
            <!-- Get All Contact Submissions -->
            <div class="test-section">
                <h3>Get All Contact Submissions</h3>
                <span class="method-tag method-get">GET /api/v1/contact</span>
                
                <button class="btn" onclick="getAllSubmissions()">Get All Submissions</button>
                <button class="btn btn-secondary" onclick="clearResponse('getAllResponse')">Clear</button>
                
                <div id="getAllResponse" class="response-area" style="display: none;"></div>
            </div>
            
            <!-- Get Contact Submission by ID -->
            <div class="test-section">
                <h3>Get Contact Submission by ID</h3>
                <span class="method-tag method-get">GET /api/v1/contact/:id</span>
                
                <div class="form-group">
                    <label>Submission ID:</label>
                    <input type="text" id="getSubmissionId" placeholder="Enter contact submission ID">
                </div>
                
                <button class="btn" onclick="getSubmissionById()">Get Submission</button>
                <button class="btn btn-secondary" onclick="clearResponse('getByIdResponse')">Clear</button>
                
                <div id="getByIdResponse" class="response-area" style="display: none;"></div>
            </div>
            
            <!-- Update Contact Submission Status -->
            <div class="test-section">
                <h3>Update Contact Submission Status</h3>
                <span class="method-tag method-put">PUT /api/v1/contact/:id/status</span>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Submission ID:</label>
                        <input type="text" id="updateSubmissionId" placeholder="Enter contact submission ID">
                    </div>
                    <div class="form-group">
                        <label>Status:</label>
                        <select id="updateStatus">
                            <option value="New">New</option>
                            <option value="In Progress" selected>In Progress</option>
                            <option value="Responded">Responded</option>
                            <option value="Closed">Closed</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Notes (optional):</label>
                    <textarea id="updateNotes" style="height: 80px;">Following up with client regarding project requirements and timeline.</textarea>
                </div>
                
                <button class="btn" onclick="updateSubmissionStatus()">Update Status</button>
                <button class="btn btn-secondary" onclick="clearResponse('updateResponse')">Clear</button>
                
                <div id="updateResponse" class="response-area" style="display: none;"></div>
            </div>
            
            <!-- Delete Contact Submission -->
            <div class="test-section">
                <h3>Delete Contact Submission</h3>
                <span class="method-tag method-delete">DELETE /api/v1/contact/:id</span>
                
                <div class="form-group">
                    <label>Submission ID:</label>
                    <input type="text" id="deleteSubmissionId" placeholder="Enter contact submission ID">
                </div>
                
                <button class="btn btn-danger" onclick="deleteSubmission()">Delete Submission</button>
                <button class="btn btn-secondary" onclick="clearResponse('deleteResponse')">Clear</button>
                
                <div id="deleteResponse" class="response-area" style="display: none;"></div>
            </div>
        </div>
    </div>

    <script>
        const BASE_URL = 'http://localhost:5000/api/v1';

        function getAuthHeaders() {
            const token = document.getElementById('authToken').value;
            return {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
            };
        }

        function loadSampleForm(type) {
            const samples = {
                webdev: {
                    name: "Alice Johnson",
                    email: "alice@techcorp.com",
                    company: "TechCorp Solutions",
                    subject: "Website Redesign Project",
                    inquiryType: "Project Quote",
                    message: "We need a complete website redesign with modern UI/UX, responsive design, and improved performance. Our current site is outdated and not mobile-friendly.",
                    budget: "$15,000 - $50,000",
                    timeline: "3-6 months"
                },
                mobile: {
                    name: "Mike Chen",
                    email: "mike@startup.io",
                    company: "Startup.io",
                    subject: "Mobile App Development",
                    inquiryType: "Project Quote",
                    message: "Looking to develop a cross-platform mobile app for iOS and Android. The app will include user authentication, real-time messaging, and payment integration.",
                    budget: "$50,000+",
                    timeline: "6+ months"
                },
                ecommerce: {
                    name: "Sarah Wilson",
                    email: "sarah@retailstore.com",
                    company: "Retail Store Inc.",
                    subject: "E-commerce Platform Development",
                    inquiryType: "Project Quote",
                    message: "We want to launch an online store with inventory management, multiple payment options, shipping integration, and analytics dashboard.",
                    budget: "$15,000 - $50,000",
                    timeline: "1-3 months"
                },
                support: {
                    name: "David Brown",
                    email: "david@existingclient.com",
                    company: "Existing Client LLC",
                    subject: "Technical Support Request",
                    inquiryType: "Technical Support",
                    message: "We're experiencing some issues with the website you developed for us. The contact form is not sending emails properly, and the site is loading slowly.",
                    budget: "Not specified",
                    timeline: "ASAP"
                }
            };

            const sample = samples[type];
            if (sample) {
                document.getElementById('submitName').value = sample.name;
                document.getElementById('submitEmail').value = sample.email;
                document.getElementById('submitCompany').value = sample.company;
                document.getElementById('submitSubject').value = sample.subject;
                document.getElementById('submitInquiryType').value = sample.inquiryType;
                document.getElementById('submitMessage').value = sample.message;
                document.getElementById('submitBudget').value = sample.budget;
                document.getElementById('submitTimeline').value = sample.timeline;
            }
        }

        async function submitContactForm() {
            const data = {
                name: document.getElementById('submitName').value,
                email: document.getElementById('submitEmail').value,
                phone: document.getElementById('submitPhone').value,
                company: document.getElementById('submitCompany').value,
                subject: document.getElementById('submitSubject').value,
                message: document.getElementById('submitMessage').value,
                inquiryType: document.getElementById('submitInquiryType').value,
                budgetRange: document.getElementById('submitBudget').value,
                timeline: document.getElementById('submitTimeline').value
            };

            try {
                const response = await fetch(`${BASE_URL}/contact`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                displayResponse('submitResponse', {
                    status: response.status,
                    statusText: response.statusText,
                    data: result
                });

                // Auto-fill ID fields with created submission ID
                if (result.success && result.data && result.data._id) {
                    document.getElementById('getSubmissionId').value = result.data._id;
                    document.getElementById('updateSubmissionId').value = result.data._id;
                    document.getElementById('deleteSubmissionId').value = result.data._id;
                }
            } catch (error) {
                displayResponse('submitResponse', {
                    error: error.message
                });
            }
        }

        async function getAllSubmissions() {
            try {
                const response = await fetch(`${BASE_URL}/contact`, {
                    headers: getAuthHeaders()
                });

                const result = await response.json();
                displayResponse('getAllResponse', {
                    status: response.status,
                    statusText: response.statusText,
                    data: result
                });
            } catch (error) {
                displayResponse('getAllResponse', {
                    error: error.message
                });
            }
        }

        async function getSubmissionById() {
            const id = document.getElementById('getSubmissionId').value;
            if (!id) {
                alert('Please enter a submission ID');
                return;
            }

            try {
                const response = await fetch(`${BASE_URL}/contact/${id}`, {
                    headers: getAuthHeaders()
                });

                const result = await response.json();
                displayResponse('getByIdResponse', {
                    status: response.status,
                    statusText: response.statusText,
                    data: result
                });
            } catch (error) {
                displayResponse('getByIdResponse', {
                    error: error.message
                });
            }
        }

        async function updateSubmissionStatus() {
            const id = document.getElementById('updateSubmissionId').value;
            if (!id) {
                alert('Please enter a submission ID');
                return;
            }

            const data = {
                status: document.getElementById('updateStatus').value,
                notes: document.getElementById('updateNotes').value
            };

            try {
                const response = await fetch(`${BASE_URL}/contact/${id}/status`, {
                    method: 'PUT',
                    headers: getAuthHeaders(),
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                displayResponse('updateResponse', {
                    status: response.status,
                    statusText: response.statusText,
                    data: result
                });
            } catch (error) {
                displayResponse('updateResponse', {
                    error: error.message
                });
            }
        }

        async function deleteSubmission() {
            const id = document.getElementById('deleteSubmissionId').value;
            if (!id) {
                alert('Please enter a submission ID');
                return;
            }

            if (!confirm('Are you sure you want to delete this contact submission?')) {
                return;
            }

            try {
                const response = await fetch(`${BASE_URL}/contact/${id}`, {
                    method: 'DELETE',
                    headers: getAuthHeaders()
                });

                const result = await response.json();
                displayResponse('deleteResponse', {
                    status: response.status,
                    statusText: response.statusText,
                    data: result
                });
            } catch (error) {
                displayResponse('deleteResponse', {
                    error: error.message
                });
            }
        }

        function displayResponse(elementId, data) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.innerHTML = JSON.stringify(data, null, 2);
        }

        function clearResponse(elementId) {
            document.getElementById(elementId).style.display = 'none';
        }
    </script>
</body>
</html>